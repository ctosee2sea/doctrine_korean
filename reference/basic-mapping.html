<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. Basic Mapping &mdash; Doctrine 2 ORM 2 documentation</title>
    <link rel="stylesheet" href="../src/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../src/default.css" type="text/css" />
    <link rel="stylesheet" href="../src/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../src/layout.css" type="text/css" />
    <link rel="stylesheet" href="../src/configurationblock.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script type="text/javascript" src="../src/jquery.js"></script>
    <script type="text/javascript" src="../src/configurationblock.js"></script>
    <script type="text/javascript" src="../src/underscore.js"></script>
    <script type="text/javascript" src="../src/configurationblock.js"></script>
    <script type="text/javascript" src="../src/doctools.js"></script>
    <script type="text/javascript" src="../src/configurationblock.js"></script>
    <script src="../src/bootstrap.min.js"></script>

    <script type="text/javascript">
    <!--
        $(document).ready(function() {
            $("#versions").change(function() {
                var docsUrl = $(this).val();
                window.location.href = docsUrl;
            });
        });
    -->
    </script>
    <link rel="shortcut icon" href="../src/doctrine.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Doctrine 2 ORM 2 documentation" href="../index.html" />
    <link rel="next" title="5. Association Mapping" href="association-mapping.html" />
    <link rel="prev" title="3. Frequently Asked Questions" href="faq.html" /> 
  
<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/basic-mapping.html" />

<link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../src/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'reference/basic-mapping' 		
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="../src/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> --></head>
  <body>
    <div id="wrapper">
      <div id="header">
        <h1 id="h1title"></h1>
        <div id="logo">
          <a href="http://www.doctrine-project.org/">Doctrine - PHP Database Libraries</a>
        </div>
      </div>
      <div id="nav" class="cls">
        <div class="tl cls">
          <ul>
            <li><a target="_top" href="http://www.doctrine-project.org/">Home</a></li>
            <li><a target="_top" href="http://www.doctrine-project.org/about.html">About</a></li>
            <li><a target="_top" href="http://www.doctrine-project.org/projects.html">Projects</a></li>
            <li><a target="_top" href="http://www.doctrine-project.org/contribute.html">Contribute</a></li>
            <li><a target="_top" href="http://www.doctrine-project.org/community.html">Community</a></li>
            <li><a target="_top" href="http://www.doctrine-project.org/archive.html">Blog</a></li>
            <li><a target="_top" href="http://www.doctrine-project.org/jira">Development</a></li>
          </ul>
        </div>
      </div>
      <div id="content" class="cls">
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="association-mapping.html" title="5. Association Mapping"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="faq.html" title="3. Frequently Asked Questions"
             accesskey="P">previous</a> |</li>
        <li><a href="/">Doctrine Homepage</a> &raquo;</li>
        <li><a href="../index.html">Doctrine 2 ORM 2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

        <div class="document">
            <div class="documentwrapper">
                <div class="bodywrapper">

              <div class="body" >
                
  <div class="section" id="basic-mapping">
<h1>4. Basic Mapping<a class="headerlink" href="#basic-mapping" title="Permalink to this headline">¶</a></h1>
<p>This guide explains the basic mapping of entities and properties.
After working through this guide you should know:</p>
<ul class="simple">
<li>How to create PHP objects that can be saved to the database with Doctrine;</li>
<li>How to configure the mapping between columns on tables and properties on
entities;</li>
<li>What Doctrine mapping types are;</li>
<li>Defining primary keys and how identifiers are generated by Doctrine;</li>
<li>How quoting of reserved symbols works in Doctrine.</li>
</ul>
<p>Mapping of associations will be covered in the next chapter on
<a class="reference internal" href="association-mapping.html"><span class="doc">Association Mapping</span></a>.</p>
<div class="section" id="guide-assumptions">
<h2>4.1. Guide Assumptions<a class="headerlink" href="#guide-assumptions" title="Permalink to this headline">¶</a></h2>
<p>You should have already <a class="reference internal" href="configuration.html"><span class="doc">installed and configure</span></a>
Doctrine.</p>
</div>
<div class="section" id="creating-classes-for-the-database">
<h2>4.2. Creating Classes for the Database<a class="headerlink" href="#creating-classes-for-the-database" title="Permalink to this headline">¶</a></h2>
<p>Every PHP object that you want to save in the database using Doctrine
is called an &#8220;Entity&#8221;. The term &#8220;Entity&#8221; describes objects
that have an identity over many independent requests. This identity is
usually achieved by assigning a unique identifier to an entity.
In this tutorial the following <code class="docutils literal"><span class="pre">Message</span></code> PHP class will serve as the
example Entity:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Message</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$id</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$text</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$postedAt</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Because Doctrine is a generic library, it only knows about your
entities because you will describe their existence and structure using
mapping metadata, which is configuration that tells Doctrine how your
entity should be stored in the database. The documentation will often
speak of &#8220;mapping something&#8221;, which means writing the mapping metadata
that describes your entity.</p>
<p>Doctrine provides several different ways to specify object-relational
mapping metadata:</p>
<ul class="simple">
<li><a class="reference internal" href="annotations-reference.html"><span class="doc">Docblock Annotations</span></a></li>
<li><a class="reference internal" href="xml-mapping.html"><span class="doc">XML</span></a></li>
<li><a class="reference internal" href="yaml-mapping.html"><span class="doc">YAML</span></a></li>
<li><a class="reference internal" href="php-mapping.html"><span class="doc">PHP code</span></a></li>
</ul>
<p>This manual will usually show mapping metadata via docblock annotations, though
many examples also show the equivalent configuration in YAML and XML.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All metadata drivers perform equally. Once the metadata of a class has been
read from the source (annotations, xml or yaml) it is stored in an instance
of the <code class="docutils literal"><span class="pre">Doctrine\ORM\Mapping\ClassMetadata</span></code> class and these instances are
stored in the metadata cache.  If you&#8217;re not using a metadata cache (not
recommended!) then the XML driver is the fastest.</p>
</div>
<p>Marking our <code class="docutils literal"><span class="pre">Message</span></code> class as an entity for Doctrine is straightforward:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/** @Entity */</span>
<span class="k">class</span> <span class="nc">Message</span>
<span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;doctrine-mapping&gt;</span>
  <span class="nt">&lt;entity</span> <span class="na">name=</span><span class="s">&quot;Message&quot;</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/entity&gt;</span>
<span class="nt">&lt;/doctrine-mapping&gt;</span>
</pre></div>
</div>
</li>
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Message</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">entity</span>
  <span class="c1"># ...</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>With no additional information, Doctrine expects the entity to be saved
into a table with the same name as the class in our case <code class="docutils literal"><span class="pre">Message</span></code>.
You can change this by configuring information about the table:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * @Entity</span>
<span class="sd"> * @Table(name=&quot;message&quot;)</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">Message</span>
<span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;doctrine-mapping&gt;</span>
  <span class="nt">&lt;entity</span> <span class="na">name=</span><span class="s">&quot;Message&quot;</span> <span class="na">table=</span><span class="s">&quot;message&quot;</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/entity&gt;</span>
<span class="nt">&lt;/doctrine-mapping&gt;</span>
</pre></div>
</div>
</li>
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Message</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">entity</span>
  <span class="l l-Scalar l-Scalar-Plain">table</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">message</span>
  <span class="c1"># ...</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Now the class <code class="docutils literal"><span class="pre">Message</span></code> will be saved and fetched from the table <code class="docutils literal"><span class="pre">message</span></code>.</p>
</div>
<div class="section" id="property-mapping">
<h2>4.3. Property Mapping<a class="headerlink" href="#property-mapping" title="Permalink to this headline">¶</a></h2>
<p>The next step after marking a PHP class as an entity is mapping its properties
to columns in a table.</p>
<p>To configure a property use the <code class="docutils literal"><span class="pre">&#64;Column</span></code> docblock annotation. The <code class="docutils literal"><span class="pre">type</span></code>
attribute specifies the <a class="reference internal" href="#reference-mapping-types"><span class="std std-ref">Doctrine Mapping Type</span></a>
to use for the field. If the type is not specified, <code class="docutils literal"><span class="pre">string</span></code> is used as the
default.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/** @Entity */</span>
<span class="k">class</span> <span class="nc">Message</span>
<span class="p">{</span>
    <span class="sd">/** @Column(type=&quot;integer&quot;) */</span>
    <span class="k">private</span> <span class="nv">$id</span><span class="p">;</span>
    <span class="sd">/** @Column(length=140) */</span>
    <span class="k">private</span> <span class="nv">$text</span><span class="p">;</span>
    <span class="sd">/** @Column(type=&quot;datetime&quot;, name=&quot;posted_at&quot;) */</span>
    <span class="k">private</span> <span class="nv">$postedAt</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;doctrine-mapping&gt;</span>
  <span class="nt">&lt;entity</span> <span class="na">name=</span><span class="s">&quot;Message&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;id&quot;</span> <span class="na">type=</span><span class="s">&quot;integer&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;text&quot;</span> <span class="na">length=</span><span class="s">&quot;140&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;postedAt&quot;</span> <span class="na">column=</span><span class="s">&quot;posted_at&quot;</span> <span class="na">type=</span><span class="s">&quot;datetime&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/entity&gt;</span>
<span class="nt">&lt;/doctrine-mapping&gt;</span>
</pre></div>
</div>
</li>
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Message</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">entity</span>
  <span class="l l-Scalar l-Scalar-Plain">fields</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">id</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="l l-Scalar l-Scalar-Plain">text</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">length</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">140</span>
    <span class="l l-Scalar l-Scalar-Plain">postedAt</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">datetime</span>
      <span class="l l-Scalar l-Scalar-Plain">column</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">posted_at</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>When we don&#8217;t explicitly specify a column name via the <code class="docutils literal"><span class="pre">name</span></code> option, Doctrine
assumes the field name is also the column name. This means that:</p>
<ul class="simple">
<li>the <code class="docutils literal"><span class="pre">id</span></code> property will map to the column <code class="docutils literal"><span class="pre">id</span></code> using the type <code class="docutils literal"><span class="pre">integer</span></code>;</li>
<li>the <code class="docutils literal"><span class="pre">text</span></code> property will map to the column <code class="docutils literal"><span class="pre">text</span></code> with the default mapping type <code class="docutils literal"><span class="pre">string</span></code>;</li>
<li>the <code class="docutils literal"><span class="pre">postedAt</span></code> property will map to the <code class="docutils literal"><span class="pre">posted_at</span></code> column with the <code class="docutils literal"><span class="pre">datetime</span></code> type.</li>
</ul>
<p>The Column annotation has some more attributes. Here is a complete
list:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">type</span></code>: (optional, defaults to &#8216;string&#8217;) The mapping type to
use for the column.</li>
<li><code class="docutils literal"><span class="pre">name</span></code>: (optional, defaults to field name) The name of the
column in the database.</li>
<li><code class="docutils literal"><span class="pre">length</span></code>: (optional, default 255) The length of the column in
the database. (Applies only if a string-valued column is used).</li>
<li><code class="docutils literal"><span class="pre">unique</span></code>: (optional, default FALSE) Whether the column is a
unique key.</li>
<li><code class="docutils literal"><span class="pre">nullable</span></code>: (optional, default FALSE) Whether the database
column is nullable.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code>: (optional, default 0) The precision for a decimal
(exact numeric) column (applies only for decimal column),
which is the maximum number of digits that are stored for the values.</li>
<li><code class="docutils literal"><span class="pre">scale</span></code>: (optional, default 0) The scale for a decimal (exact
numeric) column (applies only for decimal column), which represents
the number of digits to the right of the decimal point and must
not be greater than <em>precision</em>.</li>
<li><code class="docutils literal"><span class="pre">columnDefinition</span></code>: (optional) Allows to define a custom
DDL snippet that is used to create the column. Warning: This normally
confuses the SchemaTool to always detect the column as changed.</li>
<li><code class="docutils literal"><span class="pre">options</span></code>: (optional) Key-value pairs of options that get passed
to the underlying database platform when generating DDL statements.</li>
</ul>
</div>
<div class="section" id="doctrine-mapping-types">
<span id="reference-mapping-types"></span><h2>4.4. Doctrine Mapping Types<a class="headerlink" href="#doctrine-mapping-types" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">type</span></code> option used in the <code class="docutils literal"><span class="pre">&#64;Column</span></code> accepts any of the existing
Doctrine types or even your own custom types. A Doctrine type defines
the conversion between PHP and SQL types, independent from the database vendor
you are using. All Mapping Types that ship with Doctrine are fully portable
between the supported database systems.</p>
<p>As an example, the Doctrine Mapping Type <code class="docutils literal"><span class="pre">string</span></code> defines the
mapping from a PHP string to a SQL VARCHAR (or VARCHAR2 etc.
depending on the RDBMS brand). Here is a quick overview of the
built-in mapping types:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">string</span></code>: Type that maps a SQL VARCHAR to a PHP string.</li>
<li><code class="docutils literal"><span class="pre">integer</span></code>: Type that maps a SQL INT to a PHP integer.</li>
<li><code class="docutils literal"><span class="pre">smallint</span></code>: Type that maps a database SMALLINT to a PHP
integer.</li>
<li><code class="docutils literal"><span class="pre">bigint</span></code>: Type that maps a database BIGINT to a PHP string.</li>
<li><code class="docutils literal"><span class="pre">boolean</span></code>: Type that maps a SQL boolean or equivalent (TINYINT) to a PHP boolean.</li>
<li><code class="docutils literal"><span class="pre">decimal</span></code>: Type that maps a SQL DECIMAL to a PHP string.</li>
<li><code class="docutils literal"><span class="pre">date</span></code>: Type that maps a SQL DATETIME to a PHP DateTime
object.</li>
<li><code class="docutils literal"><span class="pre">time</span></code>: Type that maps a SQL TIME to a PHP DateTime object.</li>
<li><code class="docutils literal"><span class="pre">datetime</span></code>: Type that maps a SQL DATETIME/TIMESTAMP to a PHP
DateTime object.</li>
<li><code class="docutils literal"><span class="pre">datetimetz</span></code>: Type that maps a SQL DATETIME/TIMESTAMP to a PHP
DateTime object with timezone.</li>
<li><code class="docutils literal"><span class="pre">text</span></code>: Type that maps a SQL CLOB to a PHP string.</li>
<li><code class="docutils literal"><span class="pre">object</span></code>: Type that maps a SQL CLOB to a PHP object using
<code class="docutils literal"><span class="pre">serialize()</span></code> and <code class="docutils literal"><span class="pre">unserialize()</span></code></li>
<li><code class="docutils literal"><span class="pre">array</span></code>: Type that maps a SQL CLOB to a PHP array using
<code class="docutils literal"><span class="pre">serialize()</span></code> and <code class="docutils literal"><span class="pre">unserialize()</span></code></li>
<li><code class="docutils literal"><span class="pre">simple_array</span></code>: Type that maps a SQL CLOB to a PHP array using
<code class="docutils literal"><span class="pre">implode()</span></code> and <code class="docutils literal"><span class="pre">explode()</span></code>, with a comma as delimiter. <em>IMPORTANT</em>
Only use this type if you are sure that your values cannot contain a &#8221;,&#8221;.</li>
<li><code class="docutils literal"><span class="pre">json_array</span></code>: Type that maps a SQL CLOB to a PHP array using
<code class="docutils literal"><span class="pre">json_encode()</span></code> and <code class="docutils literal"><span class="pre">json_decode()</span></code></li>
<li><code class="docutils literal"><span class="pre">float</span></code>: Type that maps a SQL Float (Double Precision) to a
PHP double. <em>IMPORTANT</em>: Works only with locale settings that use
decimal points as separator.</li>
<li><code class="docutils literal"><span class="pre">guid</span></code>: Type that maps a database GUID/UUID to a PHP string. Defaults to
varchar but uses a specific type if the platform supports it.</li>
<li><code class="docutils literal"><span class="pre">blob</span></code>: Type that maps a SQL BLOB to a PHP resource stream</li>
</ul>
<p>A cookbook article shows how to define <a class="reference internal" href="../cookbook/custom-mapping-types.html"><span class="doc">your own custom mapping types</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">DateTime and Object types are compared by reference, not by value. Doctrine
updates this values if the reference changes and therefore behaves as if
these objects are immutable value objects.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>All Date types assume that you are exclusively using the default timezone
set by <a class="reference external" href="http://docs.php.net/manual/en/function.date-default-timezone-set.php">date_default_timezone_set()</a>
or by the php.ini configuration <code class="docutils literal"><span class="pre">date.timezone</span></code>. Working with
different timezones will cause troubles and unexpected behavior.</p>
<p class="last">If you need specific timezone handling you have to handle this
in your domain, converting all the values back and forth from UTC.
There is also a <a class="reference internal" href="../cookbook/working-with-datetime.html"><span class="doc">cookbook entry</span></a>
on working with datetimes that gives hints for implementing
multi timezone applications.</p>
</div>
</div>
<div class="section" id="identifiers-primary-keys">
<h2>4.5. Identifiers / Primary Keys<a class="headerlink" href="#identifiers-primary-keys" title="Permalink to this headline">¶</a></h2>
<p>Every entity class must have an identifier/primary key. You can select
the field that serves as the identifier with the <code class="docutils literal"><span class="pre">&#64;Id</span></code>
annotation.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Message</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Id @Column(type=&quot;integer&quot;)</span>
<span class="sd">     * @GeneratedValue</span>
<span class="sd">     */</span>
    <span class="k">private</span> <span class="nv">$id</span><span class="p">;</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;doctrine-mapping&gt;</span>
  <span class="nt">&lt;entity</span> <span class="na">name=</span><span class="s">&quot;Message&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">name=</span><span class="s">&quot;id&quot;</span> <span class="na">type=</span><span class="s">&quot;integer&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;generator</span> <span class="na">strategy=</span><span class="s">&quot;AUTO&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/id&gt;</span>
    <span class="c">&lt;!-- --&gt;</span>
  <span class="nt">&lt;/entity&gt;</span>
<span class="nt">&lt;/doctrine-mapping&gt;</span>
</pre></div>
</div>
</li>
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Message</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">entity</span>
  <span class="l l-Scalar l-Scalar-Plain">id</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">id</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
      <span class="l l-Scalar l-Scalar-Plain">generator</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">strategy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AUTO</span>
  <span class="l l-Scalar l-Scalar-Plain">fields</span><span class="p p-Indicator">:</span>
    <span class="c1"># fields here</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>In most cases using the automatic generator strategy (<code class="docutils literal"><span class="pre">&#64;GeneratedValue</span></code>) is
what you want. It defaults to the identifier generation mechanism your current
database vendor prefers: AUTO_INCREMENT with MySQL, SERIAL with PostgreSQL,
Sequences with Oracle and so on.</p>
<div class="section" id="identifier-generation-strategies">
<h3>4.5.1. Identifier Generation Strategies<a class="headerlink" href="#identifier-generation-strategies" title="Permalink to this headline">¶</a></h3>
<p>The previous example showed how to use the default identifier
generation strategy without knowing the underlying database with
the AUTO-detection strategy. It is also possible to specify the
identifier generation strategy more explicitly, which allows you to
make use of some additional features.</p>
<p>Here is the list of possible generation strategies:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">AUTO</span></code> (default): Tells Doctrine to pick the strategy that is
preferred by the used database platform. The preferred strategies
are IDENTITY for MySQL, SQLite, MsSQL and SQL Anywhere and SEQUENCE
for Oracle and PostgreSQL. This strategy provides full portability.</li>
<li><code class="docutils literal"><span class="pre">SEQUENCE</span></code>: Tells Doctrine to use a database sequence for ID
generation. This strategy does currently not provide full
portability. Sequences are supported by Oracle, PostgreSql and
SQL Anywhere.</li>
<li><code class="docutils literal"><span class="pre">IDENTITY</span></code>: Tells Doctrine to use special identity columns in
the database that generate a value on insertion of a row. This
strategy does currently not provide full portability and is
supported by the following platforms: MySQL/SQLite/SQL Anywhere
(AUTO_INCREMENT), MSSQL (IDENTITY) and PostgreSQL (SERIAL).</li>
<li><code class="docutils literal"><span class="pre">UUID</span></code>: Tells Doctrine to use the built-in Universally Unique Identifier
generator. This strategy provides full portability.</li>
<li><code class="docutils literal"><span class="pre">TABLE</span></code>: Tells Doctrine to use a separate table for ID
generation. This strategy provides full portability.
<strong>*This strategy is not yet implemented!*</strong></li>
<li><code class="docutils literal"><span class="pre">NONE</span></code>: Tells Doctrine that the identifiers are assigned (and
thus generated) by your code. The assignment must take place before
a new entity is passed to <code class="docutils literal"><span class="pre">EntityManager#persist</span></code>. NONE is the
same as leaving off the &#64;GeneratedValue entirely.</li>
<li><code class="docutils literal"><span class="pre">CUSTOM</span></code>: With this option, you can use the <code class="docutils literal"><span class="pre">&#64;CustomIdGenerator</span></code> annotation.
It will allow you to pass a <span class="xref doc">class of your own to generate the identifiers.</span></li>
</ul>
<div class="section" id="sequence-generator">
<h4>4.5.1.1. Sequence Generator<a class="headerlink" href="#sequence-generator" title="Permalink to this headline">¶</a></h4>
<p>The Sequence Generator can currently be used in conjunction with
Oracle or Postgres and allows some additional configuration options
besides specifying the sequence&#8217;s name:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Message</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Id</span>
<span class="sd">     * @GeneratedValue(strategy=&quot;SEQUENCE&quot;)</span>
<span class="sd">     * @SequenceGenerator(sequenceName=&quot;message_seq&quot;, initialValue=1, allocationSize=100)</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;doctrine-mapping&gt;</span>
  <span class="nt">&lt;entity</span> <span class="na">name=</span><span class="s">&quot;Message&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">name=</span><span class="s">&quot;id&quot;</span> <span class="na">type=</span><span class="s">&quot;integer&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;generator</span> <span class="na">strategy=</span><span class="s">&quot;SEQUENCE&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;sequence-generator</span> <span class="na">sequence-name=</span><span class="s">&quot;message_seq&quot;</span> <span class="na">allocation-size=</span><span class="s">&quot;100&quot;</span> <span class="na">initial-value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;/entity&gt;</span>
<span class="nt">&lt;/doctrine-mapping&gt;</span>
</pre></div>
</div>
</li>
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Message</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">entity</span>
  <span class="l l-Scalar l-Scalar-Plain">id</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">id</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
      <span class="l l-Scalar l-Scalar-Plain">generator</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">strategy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">SEQUENCE</span>
      <span class="l l-Scalar l-Scalar-Plain">sequenceGenerator</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">sequenceName</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">message_seq</span>
        <span class="l l-Scalar l-Scalar-Plain">allocationSize</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
        <span class="l l-Scalar l-Scalar-Plain">initialValue</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>The initial value specifies at which value the sequence should
start.</p>
<p>The allocationSize is a powerful feature to optimize INSERT
performance of Doctrine. The allocationSize specifies by how much
values the sequence is incremented whenever the next value is
retrieved. If this is larger than 1 (one) Doctrine can generate
identifier values for the allocationSizes amount of entities. In
the above example with <code class="docutils literal"><span class="pre">allocationSize=100</span></code> Doctrine 2 would only
need to access the sequence once to generate the identifiers for
100 new entities.</p>
<p><em>The default allocationSize for a &#64;SequenceGenerator is currently 10.</em></p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">The allocationSize is detected by SchemaTool and
transformed into an &#8220;INCREMENT BY &#8221; clause in the CREATE SEQUENCE
statement. For a database schema created manually (and not
SchemaTool) you have to make sure that the allocationSize
configuration option is never larger than the actual sequences
INCREMENT BY value, otherwise you may get duplicate keys.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible to use strategy=&#8221;AUTO&#8221; and at the same time
specifying a &#64;SequenceGenerator. In such a case, your custom
sequence settings are used in the case where the preferred strategy
of the underlying platform is SEQUENCE, such as for Oracle and
PostgreSQL.</p>
</div>
</div>
</div>
<div class="section" id="composite-keys">
<h3>4.5.2. Composite Keys<a class="headerlink" href="#composite-keys" title="Permalink to this headline">¶</a></h3>
<p>With Doctrine 2 you can use composite primary keys, using <code class="docutils literal"><span class="pre">&#64;Id</span></code> on more then
one column. Some restrictions exist opposed to using a single identifier in
this case: The use of the <code class="docutils literal"><span class="pre">&#64;GeneratedValue</span></code> annotation is not supported,
which means you can only use composite keys if you generate the primary key
values yourself before calling <code class="docutils literal"><span class="pre">EntityManager#persist()</span></code> on the entity.</p>
<p>More details on composite primary keys are discussed in a <a class="reference internal" href="../tutorials/composite-primary-keys.html"><span class="doc">dedicated tutorial</span></a>.</p>
</div>
</div>
<div class="section" id="quoting-reserved-words">
<h2>4.6. Quoting Reserved Words<a class="headerlink" href="#quoting-reserved-words" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is necessary to quote a column or table name because of reserved
word conflicts. Doctrine does not quote identifiers automatically, because it
leads to more problems than it would solve. Quoting tables and column names
needs to be done explicitly using ticks in the definition.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/** @Column(name=&quot;`number`&quot;, type=&quot;integer&quot;) */</span>
<span class="k">private</span> <span class="nv">$number</span><span class="p">;</span>
</pre></div>
</div>
<p>Doctrine will then quote this column name in all SQL statements
according to the used database platform.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Identifier Quoting does not work for join column names or discriminator
column names unless you are using a custom <code class="docutils literal"><span class="pre">QuoteStrategy</span></code>.</p>
</div>
<span class="target" id="reference-basic-mapping-custom-mapping-types"></span><p>For more control over column quoting the <code class="docutils literal"><span class="pre">Doctrine\ORM\Mapping\QuoteStrategy</span></code> interface
was introduced in 2.3. It is invoked for every column, table, alias and other
SQL names. You can implement the QuoteStrategy and set it by calling
<code class="docutils literal"><span class="pre">Doctrine\ORM\Configuration#setQuoteStrategy()</span></code>.</p>
<p>The ANSI Quote Strategy was added, which assumes quoting is not necessary for any SQL name.
You can use it with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Doctrine\ORM\Mapping\AnsiQuoteStrategy</span><span class="p">;</span>

<span class="nv">$configuration</span><span class="o">-&gt;</span><span class="na">setQuoteStrategy</span><span class="p">(</span><span class="k">new</span> <span class="nx">AnsiQuoteStrategy</span><span class="p">());</span>
</pre></div>
</div>
</div>
</div>


              </div>
                </div>

            </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
             
                <h3>Project Versions</h3>

                <select name="versions" id="versions">
            
            <option value="http://readthedocs.org/en/latest/">latest</option>
            
            <option value="http://readthedocs.org/en/stable/">stable</option>
            
                </select>
            
            <div id="searchbox" style="">
              <h3>Search</h3>
                <form class="search" action="http://readthedocs.org/search/project/" method="get">
                  <input type="text" name="q" size="18">
                  <input type="submit" value="Go">
                  <input type="hidden" name="selected_facets" value="project:Doctrine ORM">
                </form>
            </div>
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">4. Basic Mapping</a><ul>
<li><a class="reference internal" href="#guide-assumptions">4.1. Guide Assumptions</a></li>
<li><a class="reference internal" href="#creating-classes-for-the-database">4.2. Creating Classes for the Database</a></li>
<li><a class="reference internal" href="#property-mapping">4.3. Property Mapping</a></li>
<li><a class="reference internal" href="#doctrine-mapping-types">4.4. Doctrine Mapping Types</a></li>
<li><a class="reference internal" href="#identifiers-primary-keys">4.5. Identifiers / Primary Keys</a><ul>
<li><a class="reference internal" href="#identifier-generation-strategies">4.5.1. Identifier Generation Strategies</a><ul>
<li><a class="reference internal" href="#sequence-generator">4.5.1.1. Sequence Generator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composite-keys">4.5.2. Composite Keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quoting-reserved-words">4.6. Quoting Reserved Words</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="faq.html"
                                  title="previous chapter">3. Frequently Asked Questions</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="association-mapping.html"
                                  title="next chapter">5. Association Mapping</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/reference/basic-mapping.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
        </div>
      </div>
          <div class="clearer"></div>
        </div>
          <div class="footer">
              &copy; Copyright 2010-%y, Doctrine Project Team.
              Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.3.
            <br/>
            <a target="_BLANK" href="http://www.servergrove.com"><img src="http://www.doctrine-project.org/images/servergrove.jpg" /></a>      <br/><br/>
            <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
              <input type="hidden" name="cmd" value="_s-xclick" />
              <input type="hidden" name="hosted_button_id" value="BAE2E3XANQ77Y" />
              <input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" />
              <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" />
            </form>
          </div>
      </div>

      <div id="bot-rcnr">
        <div class="tl"><!-- corner --></div>
      </div>
    </div>

  <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
  </script>
  <script type="text/javascript">
  _uacct = "UA-288343-7";
  urchinTracker();
  </script>
  <a class="githublink" href="http://github.com/doctrine"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
  </body>
</html>